<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Atualizar Produto</title>
    </head>
<body>

    <h1>Atualizar Produto</h1>

    {% if messages %}
    <ul class="messages">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
    </ul>
    {% endif %}
    
    <form action="{% url 'products:updaterecord' myproduct.id %}" method="post">
        {% csrf_token %}

        <label for="name_field"> Nome:</label><br>
        <input name="name" value="{{ myproduct.name }}" id="name_field" placeholder="Digite um nome" required>
        <br><br>

        <label for="">Marca:</label><br>
        <input name="brand" value="{{ myproduct.brand }}" id="brand_field" placeholder="Digite uma marca" required>
        <br><br>

        <label for="price_field">Preço:</label><br>
        <input name="price" value="{{ myproduct.price }}" id="price_field" placeholder="Digite um preço" required>
        <br><br>

        <label for="stock_field">Estoque:</label><br>
        <span id="stock_field">{{ myproduct.stock }}</span>
        <br><br>
        
        <label for="sold_field">Vendidos:</label><br>
        <span id="sold_field">{{ myproduct.sold }}</span>
        <br><br>
        
        <input type="submit" value="Atualizar">
    </form>

    <h3>Compra de Produto</h3>
    <form action="{% url 'products:buyProduct' myproduct.id %}" method="post">
        {% csrf_token %}
        <label for="">Quantidade:</label><br>
        <input type="text" name="quantidade" id="quantidade_field" placeholder="Digite um número" required>
        <br><br>

        <input type="submit" value="Comprar">
    </form>

    <h3>Fornecedores do Produto</h3>
    {%if myproduct.supplier_set.all %}
        <table border="1">
            <thead>
                <th>Nome</th>
                <th>Telefone</th>
                <th>CNPJ</th>
                <th>Endereço</th>
            </thead>
            {% for supplier in myproduct.supplier_set.all%}
                <tr>
                    <td>{{supplier.name}}</td>
                    <td>{{supplier.telephone}}</td>
                    <td>{{supplier.cnpj}}</td>
                    <td>{{supplier.address}}</td>
                </tr>
            {% endfor %}
        </table>
    {% else%}
        <p>Não existem Fornecedores para esse Produto</p>
    {% endif %}
    <br>
    {% if myproduct.supplier_set.all %}
    <form action="{% url 'products:suppliers_of_product' myproduct.id%}">
        <input type="submit" name="comprarEstoque" value="Comprar Estoque">
    </form>
    {% else%}
        <p>Para comprar estoque, <a href="{% url 'suppliers:index' %}">associe um Fornecedor à esse Produto</a></p>
    {% endif %}
    <p>
        <a href="{% url 'products:index' %}">Voltar para o index</a>
    </p>
</body>
</html>